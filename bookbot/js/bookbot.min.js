Array.prototype.hasInArray=function(b){var a;for(var a=0,c=this.length;a<c;a++){if(this[a]==parseInt(b)){return true;}}return false;};var appProgressBar=function(){var a=function(c){var b=$("div#progress");
b.animate({width:c},"slow");};return{init:function(b){a(b);}};};var contactScript=function(){var b=$("input#host").val();var d=function(){$("input#contactSubmitBot").live("click",function(f){f.preventDefault();
var e="";$("form#contactForm :input").each(function(g){if($(this).is(":text, textarea")){e+=$(this).attr("name")+"="+$(this).val()+"&";}});e=e.substring(0,e.length-1);
c(e);});};var c=function(e){var f=$("img#preloaderWhite");$("input#contactSubmitBot").fadeOut("fast",function(){f.clone().appendTo("p#submit").addClass("temp");
});$.ajax({url:b+"contact/sendContact/",type:"POST",dataType:"text",data:e,success:function(g,j,i){$(".temp").remove();$("input#contactSubmitBot").fadeIn("fast");
var h="Your message was sent successfully! / Su mensaje fué enviado exitosamente!";alert(h);$("form:input").each(function(k){$(this).val("");});},error:function(h,i,g){$(".temp").remove();
log(g);}});};var a=function(){d();};return{init:a};};var selectDates=function(){var d=function(){$("input.datepicker").val("");$("input#adults").val(2).attr("disabled","disabled").datepicker("disable");
$("input#children").val(0).attr("disabled","disabled").datepicker("disable");$("input#rooms").val(1).attr("disabled","disabled").datepicker("disable");
};var b=function(g){var f=$("div#progress");if(f.width()<g){f.animate({width:g},"slow");}};var c=function(g){var f=$("p#progressMsg");switch(g){case 1:f.text($("li#book_step_1").text());
break;case 2:f.text($("li#book_step_2").text());break;case 3:f.text($("li#book_step_3").text());break;case 4:f.text($("li#book_step_4").text());break;default:f.text($("li#book_step_1").text());
}};var e=function(){$("input#submitReserve").live("click",function(h){h.preventDefault();if($("input#checkIn").val()!=""&&$("input#checkOut").val()!=""){var j=parseInt($("input#rooms").val());
var f=parseInt($("input#adults").val());var g=parseInt($("input#children").val());var i=f+g;if(i/j<=4){$("input.digit").removeAttr("disabled");$(this).closest("form").submit();
}else{alert($("input#maxPaxReached").val());}}});$("#checkIn").datepicker({numberOfMonths:2,minDate:+0,onSelect:function(f){$("input#checkInput").val(f);
$(this).closest("fieldset#datosHospedaje").animate({left:"-570px"},400,function(){console.log($("#checkInput").val());});$("div#checkOut").datepicker("enable").datepicker("option","minDate",f);
$(".gotoCheckin").removeAttr("disabled");}});$("#checkOut").datepicker({numberOfMonths:2,minDate:+0,disabled:true});$(".");$("input#checkInput").change(function(){});
$("input#checkOut").change(function(){});};var a=function(){d();c(1);e();};return{init:a};};var selectReservation=function(){var h={};var c=false;var b=new Array();
var t=false;var p=parseFloat($("span#taxAmount").text())/100;var m=$("input#host").val();var e=function(v){var u=$("p#progressMsg");switch(v){case 5:u.text($("li#book_step_5").text());
break;case 6:u.text($("li#book_step_6").text());break;case 7:u.text($("li#book_step_7").text());break;default:u.text($("li#book_step_5").text());}};var o=function(){$("p.roomType").hide();
$("div.roomDescrip").hide();};var s=function(u){$("div.roomDescrip").hide().removeClass("activeDescription");$("div#"+u).show().addClass("activeDescription");
};var i=function(u){$("p.roomType").hide().removeClass("activeRoom");$("p."+u).show().addClass("activeRoom");j();};var j=function(){var w=$("p.activeRoom").find("span.roomCost");
var y=0;w.each(function(z){y+=parseFloat($(this).text());});var x=parseFloat((y.toFixed(2)*parseFloat($.trim($("span#roomsQtyNo").text()))).toFixed(2));
var v=parseFloat(x*p);var u=parseFloat($("span#extraAdultsAmount").text());$("span#totalCost").text(y.toFixed(2));$("span#grandTotal").text(x.toFixed(2));
$("span#taxTotalAmount").text(v.toFixed(2));$("span#totalAmountNumber").text((x+v+u).toFixed(2));};var q=function(){h.roomType=$("a.activeRoomType").attr("href").substr(10);
var u=0;if(c){if(b.hasInArray(h.roomType)){alert("There is no vacancy on "+b.length+" dates that you chose, please change the date or the room type");return false;
}else{h.checkin=$("p#checkin").text();h.checkout=$("p#checkout").text();h.rooms=$.trim($("span#roomsQtyNo").text());return true;}}else{h.checkin=$("p#checkin").text();
h.checkout=$("p#checkout").text();h.rooms=$.trim($("span#roomsQtyNo").text());return true;}};var f=function(){n();if($("div#personalDetails form").valid()&&$("input#terms").is(":checked")){var w={name:$("input#name").val(),lastname:$("input#lastname").val(),email:$("input#email").val(),tel:$("input#tel").val(),country:$("input#country").val(),address:$("textarea#address").val(),city:$("input#city").val(),zip:$('select#zip').val()};
var v=$("textarea#comments").val();if(w){var u=$("button#submitPersonalDetails");u.attr("disabled","disabled");$.ajax({url:m+"reservaciones/registroUsuario/",type:"POST",dataType:"json",data:w,complete:function(x,y){u.removeAttr("disabled");
},success:function(x,z,y){h.userId=x.user;h.amount=$.trim($("span#totalAmountNumber").text());r(v);},error:function(y,z,x){}});}}else{return false;}};var k=function(){$("button#toPersonalData").attr("disabled","disabled");
$("div.reservData").fadeOut("slow",function(){$("div#personalDetails").fadeIn("slow");});};var r=function(u){$.ajax({url:m+"reservaciones/confirmAndBook/",type:"POST",dataType:"json",data:{userId:h.userId,checkin:h.checkin,checkout:h.checkout,roomType:h.roomType,roomQty:h.rooms,total_amount:h.amount,comments:u},complete:function(v,w){},success:function(w,z,x){var y=$("input#returnUrl").val();
var v=$("input#paypalIpnUrl").val();$("input#returnUrl").val(y+"/"+w.reservationId);$("input#paypalIpnUrl").val(v+"/"+w.reservationId);$("form#paypalSubmitForm").dialog({width:400,modal:true});
},error:function(w,x,v){}});};var g=function(){var u=new Array();$.each($("ul#dateList li").has("p.noAllotment"),function(v,x){var w=$(this);$.each(w.find("span.roomType"),function(y,z){noAllotmentRoomType=$(this).text();
if(!b.hasInArray(noAllotmentRoomType)){b.push(noAllotmentRoomType);}});});if(b.length>0){c=true;}};var n=function(){$("div#personalDetails form").validate({rules:{name:{required:true},lastname:{required:true},email:{required:true,email:true},tel:{required:true},address:{required:true},city:{required:true},zip:{required:true}},errorPlacement:function(u,v){v.siblings("label").after(u);
}});};var l=function(v){var u=$("div#progress");u.animate({width:v},"slow");};var d=function(){$("a.roomTypeSelect").live("click",function(w){w.preventDefault();
var v=$(this).attr("href").substr(1);var u=$(this).text();$("a.roomTypeSelect").removeClass("activeRoomType");$(this).addClass("activeRoomType");i(v);s(v);
if(b.hasInArray(v.substr(9))||parseInt($("span#roomsQtyNo").text())>parseInt($("input#roomTypeAllotment_"+v.substr(9)).val())){$("button#toPersonalData").text($("p#noAvailability").text());
$("p#roomTypeTotal").addClass("hidden");$("button#toPersonalData").addClass("inactive");$("button#toPersonalData").attr("disabled","disabled");$("span#totalRoomType").text("N/A");
if(parseInt($("span#roomsQtyNo").text())>parseInt($("input#roomTypeAllotment_"+v.substr(9)).val())){}}else{$("button#toPersonalData").text($("p#buttonText").text());
$("p#roomTypeTotal").removeClass("hidden");$("button#toPersonalData").removeClass("inactive");$("button#toPersonalData").removeAttr("disabled");$("span#totalRoomType").text(u);
}if(t){l(600);e(6);}else{l(400);t=true;}});$("button#toPersonalData").live("click",function(u){u.preventDefault();if(q()){$("input#paypalName").val($.trim($("p#roomTypeTotal").text())+" "+$.trim($("p#roomsQty").text()));
$("input#paypalAmount").val($.trim($("span#totalAmountNumber").text()));k();l(800);e(7);}});$("button#backRoomSel").live("click",function(u){u.preventDefault();
$("button#toPersonalData").removeAttr("disabled");$("div#personalDetails").fadeOut("slow",function(){$("div.reservData").fadeIn("slow");});l(600);e(6);
});$("button#captureDataAndBook").live("click",function(u){u.preventDefault();f();});$("a#termsConditions").live("click",function(u){u.preventDefault();
showTermsAndConditions();});$(window).load(function(){$("a.roomTypeSelect:first-child").click();});};var a=function(){d();o();g();e(5);};return{init:a};
};var backOffice=function(){var q=$("input#host").val();var h=null;var y=null;var r=null;var i=null;var e=function(){$(".editableData").live("click",function(B){var A=$(this);
if(!A.hasClass("editing")){var z=$.trim(A.html());if(!A.hasClass("textAreaEdit")){A.addClass("editing").empty().append('<input class="inlineEdit" type="text" name="" value="'+z+'" />');
A.find("input").fadeIn("slow",function(){A.find("input").focus();});}else{A.addClass("editing").empty().append('<textarea class="inlineEdit" type="text" name="">'+z+"</textarea>");
A.find("textarea").fadeIn("slow",function(){A.find("textarea").focus();});}}}).live("blur",function(B){var A=$(this);if(A.hasClass("editing")){A.removeClass("editing");
if(!A.hasClass("textAreaEdit")){var z=$.trim(A.find("input").val());A.find("input").remove();A.append(z);}else{var z=$.trim(A.find("textarea").val());A.find("textarea").remove();
A.append(z);}var E=$.trim(A.closest("table").siblings("p.hidden").text());var C=A.closest("td").attr("class");var D=A.closest("tr").attr("id").substr(9);
l();$.post(q+"backoffice/"+E,"cat_room_id="+$.trim(D)+"&"+C+"="+z,function(F,H,G){x();});}});$("div#tabs").tabs();$("input.date").datepicker({numberOfMonths:2});
$("a.confirm").live("click",function(A){A.preventDefault();var B=confirm("Está seguro de querer eliminar este elemento? No se podrá cancelar la eliminación.");
if(B){var z=$(this).closest("table").attr("id");var D=$.trim($(this).closest("tr").children("td").first().text());var C=$(this).closest("tr");t(z,D,C);
}else{return false;}});$("a.confirmNew").live("click",function(A){A.preventDefault();var B=confirm("Está seguro de querer eliminar este elemento? No se podrá cancelar la eliminación.");
if(B){var z=$(this).closest("ul").data("method");var D=$.trim($(this).closest("span").siblings("input.reserveId").val());var C=$(this).closest("li");t(z,D,C);
}else{return false;}});$("a.activateNotConfirmed").live("click",function(A){A.preventDefault();l();var z=$.trim($(this).closest("span").siblings("input.reserveId").val());
u(z,$(this).closest("li"));});$("button.deleteSeason").live("click",function(z){z.preventDefault();var A=confirm("Está seguro de querer eliminar esta temporada? No se podrá cancelar la eliminación.");
if(A){var C=$.trim($(this).closest("tr").attr("id"));var B=$(this).closest("tr");j(C,B);}else{return false;}});$("button#blockRoom").live("click",function(z){l();
var A=$("input#startBlock").val();var C=$("input#endBlock").val();var B=$("select#roomType").val();var F=$("select#roomType option:selected").text();var H=$("input#roomQty").val();
if(A==""||C==""||H==""){o({status:0,msg:"Por favor llene todos los campos requeridos!"});x();return false;}var D={en:{January:1,February:2,March:3,April:4,May:5,June:6,July:7,August:8,September:9,October:10,November:11,December:12}};
var G=$("#dashboardCalendarActualMonth").text();var E=G.substring(0,G.length-5);E=D.en[E];var G=G.substr(G.length-4);$.ajax({url:q+"backoffice/checkDatesForDateRangeBlocking/",type:"POST",dataType:"json",data:{checkIn:A,checkOut:C,dateRange:1},complete:function(I,J){k(G,E);
},success:function(I,K,J){if(s(I,B)){v(A,C,B,H,F,1);}},error:function(J,K,I){}});});$("button#saveSeason").live("click",function(z){l();p($(this));});$("button.activateSeason").live("click",function(z){var B=$.trim($(this).closest("tr").attr("id"));
var A=$(this).closest("tr").find("td.season_name").text();g(B,A);});$("button#saveSeasonPrices").click(function(){var z=$(this).closest(".ui-dialog").find(".ui-dialog-title").text();
c(z);});$("button.variableSend").live("click",function(z){a($(this));l();});$("th#prevMonth>a, th#nextMonth>a").live("click",function(z){z.preventDefault();
l();var A=$(this).attr("href")+"/1/";$.ajax({url:A,type:"GET",dataType:"html",complete:function(B,C){x();},success:function(B,E,D){$("div.availabilityCalendar").empty();
$("div.availabilityCalendar").append(B);var C=$("table.dashboardCalendar").find("tr:first");w(C,0.9);},error:function(C,D,B){}});});$("td.calday").live("click",function(E){var A=$(this);
var C=A.find(".hiddenCalDate").val();var B="";var D="";if(C!==undefined){var z=$("div.dateBlockPanel").clone();i=z.dialog({modal:true,title:"Disponibilidad por fecha",open:function(){A.find("p.dateAllotment").each(function(F){B=$(this).find("input.roomTypeId").val();
roomAvailability=$(this).find("span.allotmentNumber").text();$("tr.roomAvailCat_"+B).find("input.roomAllotmentField").val(roomAvailability);$("tr.roomAvailCat_"+B).find("input.roomTypeActualAllotment").val(roomAvailability);
});z.find(".blockingDate").val(A.find(".hiddenCalDate").val());},close:function(){i.remove();i=null;}});}});$("button#saveDateAllotment").live("click",function(C){C.preventDefault();
l();var A=$(this);var B=A.closest("table.controlPanel").find("tr.roomTypeRow");var z=0;B.each(function(H){var L=$(this).find("input.roomTypeActualAllotment").val();
var E=$(this).find("input.roomAllotmentField").val();if(L>E){var M=L-E;var F=$(this).find("input.roomTypeIdContainer").val();var J=$(this).find(".roomLabelName").text();
var D=A.siblings(".blockingDate").val();var G=D.split("-");var K=G[0];var I=G[1];G=new Date(G[0],G[1]-1,G[2]);G=new Date(G.getFullYear(),G.getMonth(),G.getDate()+1);
G=G.getFullYear()+"-"+parseInt(G.getMonth()+1)+"-"+G.getDate();D=D.split("-");D=D[0]+"/"+D[1]+"/"+D[2];G=G.split("-");G=G[0]+"/"+G[1]+"/"+G[2];z++;$.ajax({url:q+"backoffice/checkDatesForBlocking/",type:"POST",dataType:"json",data:{checkIn:D,checkOut:G},complete:function(N,O){z--;
if(z===0){i.remove();i=null;k(K,I);}},success:function(N,P,O){if(s(N,F)){v(D,G,F,M,J,0);}},error:function(O,P,N){}});}});});};var m=function(){$("tbody tr").removeClass("zebra");
$("tbody tr:even").addClass("zebra");};var l=function(){var z=$("div.preloader").clone();h=z.dialog({modal:true});};var x=function(){h.dialog("close");
h.remove();h=null;};var a=function(B){var z=B.closest("tr").find("input");var A=z.attr("id");var C=$.trim(z.val());$.ajax({url:q+"backoffice/setVariable",type:"POST",dataType:"json",data:{value:C,variable:A},complete:function(D,E){x();
},success:function(D,F,E){o(D);},error:function(E,F,D){}});};var u=function(z,A){$.getJSON(q+"backoffice/activateUnconfirmedReserve/"+z,function(D,F){x();
if(parseInt(D.requestStatus)){var B=A.clone();A.remove();$("ul#reservasList").append(B);var E=B.prev("li").find("span.editReserveButton").clone();var C=B.prev("li").find("span.cancelReserveButton").clone();
B.find("span.activateNotConfirmedButton").replaceWith(E);B.find("span.cancelUnconfirmedButton").replaceWith(C);}});};var f=function(C,A){var z=$("tr.seasonPricesRow").clone().attr("id","season_id_"+C).removeClass("seasonPricesRow");
z.find("td.seasonPriceName").text(A.seasonName);var B=z.find("td.seasonPriceCell").clone().removeAttr("id");z.find("td#tempPriceCell").remove();$.each(A.priceList,function(E,F){var D=B.clone().text(A.priceList[E]).removeClass("seasonPriceCell");
z.append(D);});$("table#seasonEdit").append(z);w(z,0.9);};var c=function(B){l();var E=$("div#seasonActivate").find("input#seasonId").val();var D=$("tr.roomType").size();
var z=0;var C=new Object();var A=false;C.priceList=new Object();C.seasonName=B;$("tr.roomType input.seasonPriceInput").each(function(F){if($(this).val()==""){o({status:0,msg:"Por favor ingrese los precios de cada tipo de habitacion."});
A=true;}});if(A){x();return false;}$("tr.roomType").each(function(F){var H=$(this).attr("id").substr(8);var G=$(this).find("input.seasonPriceInput").val();
C.priceList["cat_room_id_"+H]=G;$.ajax({url:q+"backoffice/setSeasonPrice/",type:"POST",dataType:"json",data:{seasonId:E,roomCat:H,price:G},complete:function(I,J){},success:function(I,K,J){z++;
if(z==D){f(E,C);r.dialog("close");r=null;x();}},error:function(J,K,I){}});});};var g=function(A,z){$("div#seasonActivate").find("input#seasonId").val(A);
r=$("div#seasonActivate").dialog({width:500,modal:true,title:z});};var p=function(z){$.ajax({url:q+"backoffice/newSeason/",type:"POST",dataType:"json",data:{season_name:$("input#seasonName").val(),date_season_start:$("input#seasonStart").val(),date_season_end:$("input#seasonEnd").val(),season_comments:$("input#seasonDescrip").val()},complete:function(A,B){x();
},success:function(B,E,D){o(B);if(B.status){var C=z.closest("tr");var A=$("tr#seasonRow").clone().attr("id",B.seasonId);A.find("td.season_name").text($("input#seasonName").val()).end().find("td.date_season_start").text($("input#seasonStart").val()).end().find("td.date_season_end").text($("input#seasonEnd").val()).end().find("td.season_comments").text($("input#seasonDescrip").val()).end().css("background-color","#87dc8d");
$("table#activeSeasons tbody").prepend(A);setTimeout(function(){w(A,0.9);},2000);}},error:function(B,C,A){}});};var j=function(A,z){l();$.ajax({url:q+"backoffice/deleteSeason/"+A,type:"GET",dataType:"json",complete:function(B,C){x();
},success:function(B,D,C){if(B.status){$("tr#season_id_"+A).remove();z.fadeOut("slow");}o(B);},error:function(C,D,B){}});};var s=function(D,A){Object.size=function(H){var G=0,F;
for(F in H){if(H.hasOwnProperty(F)){G++;}}return G;};var z=new Object();$.each(D,function(F,G){$.each(G,function(J,I){if(J==A){if(I==0){var H=F;z[F]=I;
}}});});var B=Object.size(z);if(B>0){var C="";$.each(z,function(F,G){C+=F+" ";});var E={status:0,msg:"Todas las habitaciones están reservadas en las siguientes fechas: "+C};
o(E);return false;}else{return true;}};var v=function(E,A,B,C,z,D){$.ajax({url:q+"backoffice/blockRoomDates/",type:"POST",dataType:"json",data:{start:E,end:A,roomType:B,roomQty:C,range:D},complete:function(F,G){},success:function(I,L,K){var J=$("tr#blockRoomRow").clone();
var G=I.reservationId;var F=E.split("/");var H=A.split("/");if(F[2].length==1){F[2]="0"+F[2];}if(F[1].length==1){F[1]="0"+F[1];}if(H[2].length==1){H[2]="0"+H[2];
}if(H[1].length==1){H[1]="0"+H[1];}J.removeAttr("id").find("td.hidden").text(G).end().find("td.blockRoomTypeCell").text(z).end().find("td.blockRoomStartCell").text(F[2]+"/"+F[1]+"/"+F[0]).end().find("td.blockRoomQtyCell").text(C).end().find("td.blockRoomEndCell").text(H[2]+"/"+H[1]+"/"+H[0]);
$("table#block").prepend(J);},error:function(G,H,F){}});};var k=function(z,B){var A=q+"backoffice/availabilityCalendar/"+z+"/"+B+"/1/";$.ajax({url:A,type:"GET",dataType:"html",complete:function(C,D){x();
},success:function(C,F,E){$("div.availabilityCalendar").empty();$("div.availabilityCalendar").append(C);var D=$("table.dashboardCalendar").find("tr:first");
w(D,0.9);},error:function(D,E,C){}});};var o=function(z){if(z.status){var A=$('<p class="confirmation">'+z.msg+"</p>").dialog({modal:true,buttons:{Ok:function(){$(this).dialog("close");
}}});}else{var A=$('<p class="error">'+z.msg+"</p>").dialog({modal:true,buttons:{Ok:function(){$(this).dialog("close");}}});}m();setTimeout(function(){A.dialog("close");
},1500);};var t=function(z,B,A){l();switch(z){case"reservas":d(B,A);break;case"reservasNoConfirmadas":d(B,A);break;case"clientes":n(B,A);break;case"block":d(B,A);
break;}};var d=function(z,A){$.ajax({url:q+"backoffice/cancelReserve/"+z,type:"GET",dataType:"json",complete:function(B,C){x();},success:function(B,D,C){o(B);
if(B.status){A.fadeOut("slow");}},error:function(C,D,B){}});};var n=function(z,A){$.ajax({url:q+"backoffice/deleteClient/"+z,type:"GET",dataType:"json",complete:function(B,C){x();
},success:function(B,D,C){o(B);if(B.status){A.fadeOut("slow");}},error:function(C,D,B){}});};var w=function(A,z){z-=0.01;if(z<0.1){clearTimeout(y);A.removeAttr("style");
m();return false;}A.css("background-color","rgba(135,220,141,"+z+")");y=setTimeout(function(){w(A,z);},50);};var b=function(){e();m();};return{init:b};
};$(function(){var a=new selectDates();a.init();});